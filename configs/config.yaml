defaults:
  - federation: local_2do
  - retriever: faiss_ivf
  - merger: rrf
  - llm: smollm_1.7b
  - privacy: none
  - _self_

dataset:
  use_subset: false  # Default to full datasets

# Runtime behavior
runtime:
  clean: true  # Cleanup federation directories after run (set to false to keep for inspection)

# MLflow experiment tracking
mlflow:
  enabled: true  # Set to true to enable MLflow tracking
  tracking_uri: "auto"  # Automatically set to <hydra_output_dir>/.mlflow
  experiment_name: "SaferBench"  # Name for the MLflow experiment

# QA Datasets
qa:
  datasets: "pubmedqa|bioasq"
  num_questions: 100  # Number of questions per dataset. When run dry, will be 2
  query_types: ["factual", "reasoning", "comparative"]  # From README

# Retrieval parameters
retrieval:
  k_nn: 8  # k-nearest neighbors (can sweep: 1, 5, 10, 20)
  chunk_size: 512  # Chunk size (can sweep: 256, 512, 1024)
  chunk_overlap: 50  # Overlap (can sweep: 0, 50, 100)
  similarity_metric: "cosine"  # cosine, L2, inner_product

# Evaluation settings
evaluation:
  # Quality metrics for multiple-choice QA
  accuracy_metrics:
    - overall_accuracy        # Weighted accuracy across datasets
    - per_dataset_accuracy    # Accuracy for each dataset
    - per_option_accuracy     # Accuracy breakdown by option (A/B/C/D)
    - confusion_matrix        # Expected vs Predicted distribution
    - option_distribution     # Which options the model selects most often

  # Efficiency metrics (timing breakdown)
  efficiency_metrics:
    - retrieval_time          # Federated document retrieval time
    - merge_time              # Document merging (RRF) time
    - generation_time         # LLM inference time
    - total_query_time        # End-to-end query time
    - queries_per_second      # Throughput

  # Privacy-utility tradeoff metrics (FEDERATED-SPECIFIC)
  privacy_metrics:
    - approval_rate           # Percentage of DOs that approved jobs
    - accuracy_drop_with_privacy  # Accuracy loss compared to 100% approval baseline

  # Federation-specific metrics
  federation_metrics:
    - federation_size         # Number of participating DOs
    - participation_rate      # % of DOs that responded to queries
    - communication_time      # Network time for federated retrieval
    - communication_ratio     # Network time / total query time
    - per_do_contribution     # % of final documents from each DO
    - data_source_diversity   # Number of unique sources in merged docs
    - merge_strategy_impact   # Comparison of merging strategies (future)

  seed: 42
  output_dir: "outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}_${federation.name}"

# Hydra configuration
hydra:
  run:
    dir: outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}_${federation.name}
  sweep:
    dir: multirun/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}
  job_logging:
    formatters:
      simple:
        format: '[%(levelname)s] - %(message)s'